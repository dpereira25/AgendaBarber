{% extends 'base.html' %}
{% block content %}

<!-- Mensaje de bienvenida personalizado -->
{% if user.is_authenticated %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert {% if es_barbero %}alert-primary{% else %}alert-success{% endif %} border-0 shadow-sm">
                <h4 class="alert-heading mb-2">
                    <i class="fas {% if es_barbero %}fa-user-tie{% else %}fa-user{% endif %} me-2"></i>
                    隆Bienvenido{% if es_barbero %} de vuelta{% endif %}, {{ user.get_full_name|default:user.username }}!
                </h4>
                <p class="mb-0">
                    {% if es_barbero %}
                        Aqu铆 tienes un resumen de tus reservas pendientes para hoy.
                    {% else %}
                        Aqu铆 puedes ver tus pr贸ximas reservas y agendar nuevos servicios.
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
{% else %}
    <div class="row mb-5">
        <div class="col-12 text-center">
            <h1 class="display-4 fw-bold text-primary mb-3">Agenda Barber </h1>
            <p class="lead text-muted mb-4">Tu barber铆a de confianza. Agenda tu cita de forma f谩cil y r谩pida.</p>
            <div class="d-flex justify-content-center gap-3">
                <a href="{% url 'login' %}" class="btn btn-primary btn-lg">
                    <i class="fas fa-sign-in-alt me-2"></i>Iniciar Sesi贸n
                </a>
                <a href="{% url 'registro' %}" class="btn btn-outline-primary btn-lg">
                    <i class="fas fa-user-plus me-2"></i>Registrarse
                </a>
            </div>
        </div>
    </div>
{% endif %}

<!-- Secci贸n personalizada para barberos -->
{% if user.is_authenticated and es_barbero %}
<div class="row mb-5">
    <div class="col-12">
        <div class="card border-primary">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">
                    <i class="fas fa-calendar-day me-2"></i>Tus Reservas Pendientes de Hoy
                </h4>
            </div>
            <div class="card-body">
                {% if reservas_hoy %}
                    <div class="row">
                        {% for reserva in reservas_hoy %}
                        <div class="col-md-6 col-lg-4 mb-3">
                            <div class="card border-warning">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                        <h6 class="card-title mb-0">{{ reserva.inicio|date:"H:i" }}</h6>
                                        <span class="badge bg-warning">Pendiente</span>
                                    </div>
                                    <p class="card-text mb-1">
                                        <i class="fas fa-user me-1"></i>
                                        <strong>{{ reserva.cliente.get_full_name|default:reserva.cliente.username }}</strong>
                                    </p>
                                    <p class="card-text mb-1">
                                        <i class="fas fa-cut me-1"></i>{{ reserva.servicio.nombre }}
                                    </p>
                                    <p class="card-text mb-0 text-muted small">
                                        <i class="fas fa-clock me-1"></i>{{ reserva.servicio.duracion_minutos }} min
                                    </p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="text-center mt-3">
                        <a href="{% url 'agenda_barbero' %}" class="btn btn-primary">
                            <i class="fas fa-calendar-alt me-1"></i>Ver Agenda Completa
                        </a>
                    </div>
                {% else %}
                    <div class="text-center py-4">
                        <i class="fas fa-calendar-check fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No tienes reservas pendientes para hoy</h5>
                        <p class="text-muted">隆Perfecto! Puedes relajarte o revisar tu agenda completa.</p>
                        <a href="{% url 'agenda_barbero' %}" class="btn btn-outline-primary">
                            <i class="fas fa-calendar-alt me-1"></i>Ver Mi Agenda
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Secci贸n personalizada para clientes -->
{% if user.is_authenticated and es_cliente %}
<div class="row mb-5">
    <div class="col-12">
        <div class="card border-success">
            <div class="card-header bg-success text-white">
                <h4 class="mb-0">
                    <i class="fas fa-clock me-2"></i>Tus Pr贸ximas Reservas
                </h4>
            </div>
            <div class="card-body">
                {% if proximas_reservas %}
                    <div class="row">
                        {% for reserva in proximas_reservas %}
                        <div class="col-md-6 col-lg-4 mb-3">
                            <div class="card {% if reserva.estado == 'Confirmada' %}border-success{% else %}border-warning{% endif %}">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                        <h6 class="card-title mb-0">{{ reserva.inicio|date:"d/m" }} - {{ reserva.inicio|date:"H:i" }}</h6>
                                        <span class="badge {% if reserva.estado == 'Confirmada' %}bg-success{% else %}bg-warning{% endif %}">
                                            {{ reserva.estado }}
                                        </span>
                                    </div>
                                    <p class="card-text mb-1">
                                        <i class="fas fa-user-tie me-1"></i>
                                        <strong>{{ reserva.barbero.nombre }}</strong>
                                    </p>
                                    <p class="card-text mb-1">
                                        <i class="fas fa-cut me-1"></i>{{ reserva.servicio.nombre }}
                                    </p>
                                    <p class="card-text mb-0 text-muted small">
                                        <i class="fas fa-calendar me-1"></i>{{ reserva.inicio|date:"l" }}
                                    </p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="text-center mt-3">
                        <a href="{% url 'mis_reservas' %}" class="btn btn-success">
                            <i class="fas fa-list me-1"></i>Ver Todas Mis Reservas
                        </a>
                    </div>
                {% else %}
                    <div class="text-center py-4">
                        <i class="fas fa-calendar-plus fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No tienes reservas pr贸ximas</h5>
                        <p class="text-muted">隆Es hora de agendar tu pr贸ximo corte!</p>
                        <a href="{% url 'crear_reserva' %}" class="btn btn-success">
                            <i class="fas fa-plus me-1"></i>Crear Nueva Reserva
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endif %}

{% if servicios %}
<div class="row mb-4">
    <div class="col-12">
        <h2 class="text-center">
            {% if user.is_authenticated %}
                Servicios Disponibles
            {% else %}
                Nuestros Servicios Destacados
            {% endif %}
        </h2>
        {% if not user.is_authenticated %}
            <p class="text-center text-muted">Descubre nuestros servicios profesionales de barber铆a</p>
        {% endif %}
    </div>
</div>

<div class="scrollable-cards-container mb-5">
    
    {% for servicio in servicios %}
    <div class="card-feature"> 
        <div class="card h-100 shadow border-0 bg-white">
            
            <div class="ratio ratio-4x3"> 
                <img src="{{ servicio.imagen.url }}" class="card-img-top w-100 h-100" 
                     alt="{{ servicio.nombre }}" style="object-fit: cover; border-radius: .375rem .375rem 0 0;">
            </div>
            
            <div class="card-body d-flex flex-column">
                <h5 class="card-title text-primary">{{ servicio.nombre }}</h5>
                <p class="card-text text-muted small">
                    {{ servicio.descripcion|truncatewords:15 }}
                </p>
                <p class="h4 text-danger mt-auto">
                    ${{ servicio.precio }}
                </p>
            </div>
            <div class="card-footer bg-white border-0 pt-0">
                <a href="{% url 'crear_reserva' %}?servicio_id={{ servicio.id }}" class="btn btn-dark w-100">
                    Reservar ahora
                </a>
            </div>
        </div>
    </div>
    {% endfor %}

</div>
{% endif %}

<button class="btn btn-info mt-5" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">Informaci贸n importante</button>

<div class="offcanvas offcanvas-start text-bg-dark" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1"
    id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Conceptos que debes entender</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <p>Actualmente en internet hay muchos conceptos que te pueden dificultar la eleccion de tu corte de pelo pero aqui te los explico de manera sencilla.</p>
        <p>FADE: Fade es literalmente degradado en ingles y cuando dicen high, medium o low, se refieren a la altura de este que se define que tan corto lo quieres.</p>
        <p>TEXTURA: Se refiere a crear irregularidades en la parte superior para crear movimiento en el pelo y dar un aspecto "despeinado" o mas casual.</p>
        <p>COMPRIMIDO: Hace referencia a que tan estirado quieres el degradado, un degradado comprimido ocupara muy poco espacio pero tendra un mayor impacto visual, en cambio uno muy estirado se vera muy pulido pero con menor impacto.</p>
        <p>TERMINACION: Un degradado tradicional puede tener terminacion redonda o en punta (tambien conocida como en V), no siempre un degradado ser rapado o con la 0, lo que permite tener patillas en punta o cuadradas y la parte posterior redonda o cuadrada.</p>
        <p>ESPERO SEA UTIL ESTA INFORMACION</p>
    </div>
</div>
{% endblock %}